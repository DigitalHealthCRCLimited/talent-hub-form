<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Adaptive Logic - Talent Hub</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .test-panel {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #444;
        }
        .test-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        .test-control {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .test-control label {
            font-weight: bold;
            color: #fff;
        }
        .test-control select {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #666;
            background: #333;
            color: #fff;
        }
        .test-results {
            background: #1a1a1a;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #333;
            margin-top: 15px;
        }
        .field-count {
            font-size: 1.2em;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 10px;
        }
        .hidden-field {
            opacity: 0.5;
            background: #442222;
        }
        .visible-field {
            background: #224422;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <h1>Talent Hub - Adaptive Logic Test</h1>
                <p>Test the two-dimensional adaptive form logic</p>
            </div>
        </div>

        <div class="test-panel">
            <h2>Test Controls</h2>
            <div class="test-controls">
                <div class="test-control">
                    <label for="testBudget">Budget Range:</label>
                    <select id="testBudget">
                        <option value="Under $5K">Under $5K (Simple)</option>
                        <option value="$5K-15K">$5K-15K (Simple)</option>
                        <option value="$15K-50K">$15K-50K (Standard)</option>
                        <option value="$50K-100K">$50K-100K (Standard)</option>
                        <option value="$100K-250K">$100K-250K (Complex)</option>
                        <option value="$250K+">$250K+ (Complex)</option>
                    </select>
                </div>
                <div class="test-control">
                    <label for="testDuration">Project Duration:</label>
                    <select id="testDuration">
                        <option value="1-2 weeks">1-2 weeks (Simple)</option>
                        <option value="3-4 weeks">3-4 weeks (Simple)</option>
                        <option value="1-3 months">1-3 months (Standard)</option>
                        <option value="3-6 months">3-6 months (Standard)</option>
                        <option value="6-12 months">6-12 months (Complex)</option>
                        <option value="12+ months">12+ months (Complex)</option>
                    </select>
                </div>
                <div class="test-control">
                    <label for="testType">Project Type:</label>
                    <select id="testType">
                        <option value="Strategic">Strategic</option>
                        <option value="Technical">Technical</option>
                        <option value="Operational">Operational</option>
                    </select>
                </div>
            </div>
            <button onclick="testAdaptiveLogic()" class="submit-btn">Test Adaptive Logic</button>
            
            <div class="test-results" id="testResults">
                <div class="field-count" id="fieldCount">Select options above to test</div>
                <div id="complexityInfo"></div>
                <div id="fieldVisibility"></div>
            </div>
        </div>

        <div class="form-container">
            <div id="loadingMessage" class="loading-message">
                <div class="loading-spinner"></div>
                <p>Loading form configuration...</p>
            </div>
            
            <div id="dynamicForm" style="display: none;">
                <!-- Form will be dynamically generated here -->
            </div>
            
            <div id="errorMessage" class="error-message" style="display: none;">
                <p>Error loading form configuration. Please try refreshing the page.</p>
            </div>
        </div>
    </div>

    <!-- Load JavaScript modules in correct order -->
    <script src="js/formGenerator.js"></script>
    <script src="js/formSubmission.js"></script>
    <script src="js/progressTracker.js"></script>
    <script src="js/uiManager.js"></script>
    <script src="js/complexityCalculator.js"></script>
    <script src="js/adaptiveConditionalLogic.js"></script>
    <script src="js/app.js"></script>

    <script>
        // Test function
        function testAdaptiveLogic() {
            const budget = document.getElementById('testBudget').value;
            const duration = document.getElementById('testDuration').value;
            const type = document.getElementById('testType').value.toLowerCase();
            
            // Calculate complexity
            const calculator = new ComplexityCalculator();
            const complexity = calculator.calculateComplexity(budget, duration);
            
            // Update form fields if form is loaded
            const form = document.getElementById('dynamicGeneratedForm');
            if (form) {
                // Set form values
                const budgetField = form.querySelector('[name="budgetrange"]');
                const durationField = form.querySelector('[name="projectduration"]');
                const typeField = form.querySelector('[name="problemcategory"]');
                
                if (budgetField) budgetField.value = budget;
                if (durationField) durationField.value = duration;
                if (typeField) {
                    const typeRadio = form.querySelector(`[name="problemcategory"][value="${type.charAt(0).toUpperCase() + type.slice(1)}"]`);
                    if (typeRadio) typeRadio.checked = true;
                }
                
                // Trigger adaptive logic
                if (window.adaptiveLogic) {
                    window.adaptiveLogic.handleComplexityChange();
                    window.adaptiveLogic.handleProjectTypeChange();
                }
            }
            
            // Display results
            updateTestResults(complexity, type, budget, duration);
        }
        
        function updateTestResults(complexity, type, budget, duration) {
            const fieldCount = document.getElementById('fieldCount');
            const complexityInfo = document.getElementById('complexityInfo');
            const fieldVisibility = document.getElementById('fieldVisibility');
            
            // Count visible fields
            const visibleFields = document.querySelectorAll('.field-wrapper:not([style*="display: none"])');
            const totalFields = document.querySelectorAll('.field-wrapper');
            
            fieldCount.textContent = `Visible Fields: ${visibleFields.length} / ${totalFields.length}`;
            
            complexityInfo.innerHTML = `
                <strong>Complexity Calculation:</strong><br>
                Budget: ${budget} → Complexity: ${complexity}<br>
                Duration: ${duration} → Complexity: ${complexity}<br>
                Project Type: ${type.charAt(0).toUpperCase() + type.slice(1)}<br>
                <strong>Final Complexity: ${complexity.toUpperCase()}</strong>
            `;
            
            // Show field visibility details
            let visibilityHTML = '<strong>Field Visibility:</strong><br>';
            const allFields = document.querySelectorAll('.field-wrapper');
            allFields.forEach(field => {
                const fieldName = field.getAttribute('data-field-name');
                const isVisible = field.style.display !== 'none';
                const isUniversal = field.getAttribute('data-is-universal') === 'true';
                
                visibilityHTML += `<span class="${isVisible ? 'visible-field' : 'hidden-field'}">${fieldName}: ${isVisible ? 'Visible' : 'Hidden'} ${isUniversal ? '(Universal)' : ''}</span><br>`;
            });
            
            fieldVisibility.innerHTML = visibilityHTML;
        }
        
        // Wait for app to load before enabling test
        window.addEventListener('load', function() {
            setTimeout(() => {
                if (window.talentHubApp) {
                    console.log('App loaded, test ready');
                }
            }, 2000);
        });
    </script>
</body>
</html>